{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://mark-a-spot.org/schemas/nuxt-config.json",
  "title": "Mark-a-Spot Nuxt Configuration",
  "description": "Jurisdiction-specific configuration for the Nuxt frontend",
  "type": "object",
  "properties": {
    "client": {
      "type": "object",
      "title": "Client Branding",
      "description": "Branding and identity settings",
      "properties": {
        "name": {
          "type": "string",
          "title": "Application Name",
          "description": "Full name shown in header and title",
          "minLength": 1,
          "maxLength": 100,
          "examples": ["Mängelmelder Bonn", "Sags uns Köln"]
        },
        "shortName": {
          "type": "string",
          "title": "Short Name",
          "description": "Abbreviated name for mobile/PWA",
          "maxLength": 20,
          "examples": ["Bonn", "Köln"]
        },
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Primary domain for this jurisdiction",
          "format": "hostname",
          "examples": ["melder.bonn.de"]
        }
      },
      "required": ["name"]
    },
    "theme": {
      "type": "object",
      "title": "Theme",
      "description": "Colors and typography",
      "properties": {
        "primary": {
          "type": "string",
          "title": "Primary Color",
          "description": "Main brand color (buttons, links, accents)",
          "enum": [
            "slate", "gray", "zinc", "neutral", "stone",
            "red", "orange", "amber", "yellow", "lime",
            "green", "emerald", "teal", "cyan", "sky",
            "blue", "indigo", "violet", "purple", "fuchsia",
            "pink", "rose"
          ],
          "default": "blue"
        },
        "secondary": {
          "type": "string",
          "title": "Secondary Color",
          "description": "Accent color for secondary actions",
          "enum": [
            "slate", "gray", "zinc", "neutral", "stone",
            "red", "orange", "amber", "yellow", "lime",
            "green", "emerald", "teal", "cyan", "sky",
            "blue", "indigo", "violet", "purple", "fuchsia",
            "pink", "rose"
          ],
          "default": "violet"
        },
        "neutral": {
          "type": "string",
          "title": "Neutral Color",
          "description": "Background and text colors",
          "enum": ["slate", "gray", "zinc", "neutral", "stone"],
          "default": "slate"
        },
        "fonts": {
          "type": "object",
          "title": "Typography",
          "description": "Font families for headings and body text",
          "properties": {
            "heading": {
              "type": "string",
              "title": "Heading Font",
              "description": "Font for headings (h1-h6)",
              "maxLength": 100,
              "examples": ["Inter", "Roboto", "Open Sans", "Montserrat"]
            },
            "body": {
              "type": "string",
              "title": "Body Font",
              "description": "Font for body text",
              "maxLength": 100,
              "examples": ["Inter", "Roboto", "Open Sans", "Source Sans Pro"]
            }
          }
        },
        "ui": {
          "type": "object",
          "title": "UI Theme Settings",
          "description": "Theme-level UI customizations",
          "properties": {
            "leftSidebar": {
              "type": "object",
              "title": "Left Sidebar",
              "properties": {
                "width": {
                  "type": "string",
                  "title": "Width",
                  "description": "Sidebar width on desktop",
                  "pattern": "^\\d+px$",
                  "default": "420px"
                }
              }
            }
          }
        }
      }
    },
    "features": {
      "type": "object",
      "title": "Feature Toggles",
      "description": "Enable or disable features for this jurisdiction",
      "properties": {
        "voting": {
          "type": "boolean",
          "title": "Voting",
          "description": "Allow citizens to vote on reports",
          "default": false
        },
        "statistics": {
          "type": "boolean",
          "title": "Statistics Tab",
          "description": "Show statistics/analytics tab",
          "default": false
        },
        "photoReporting": {
          "type": "boolean",
          "title": "Photo Reporting",
          "description": "Enable photo-first reporting flow",
          "default": true
        },
        "dashboard": {
          "type": "boolean",
          "title": "Dashboard",
          "description": "Enable admin dashboard for staff",
          "default": false
        },
        "passwordless": {
          "type": "boolean",
          "title": "Passwordless Auth",
          "description": "Enable email-based login (requires Drupal module)",
          "default": false
        },
        "aiAnalysis": {
          "type": "boolean",
          "title": "AI Analysis",
          "description": "Enable AI-powered image analysis",
          "default": false
        },
        "feedback": {
          "type": "boolean",
          "title": "Feedback",
          "description": "Allow feedback on service provider responses",
          "default": true
        },
        "offline": {
          "type": "boolean",
          "title": "Offline Mode",
          "description": "Enable offline support with service worker caching",
          "default": false
        },
        "formFirst": {
          "type": "boolean",
          "title": "Form-First Mobile",
          "description": "Show form before map on mobile devices",
          "default": true
        },
        "emergency": {
          "type": "object",
          "title": "Emergency Mode",
          "description": "Emergency mode redirects to lite version",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable Emergency Mode",
              "description": "When true, app checks backend status and may redirect to /lite",
              "default": false
            }
          }
        },
        "funFacts": {
          "type": "object",
          "title": "Fun Facts",
          "description": "Display fun facts on success page",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable Fun Facts",
              "default": false
            }
          }
        },
        "search": {
          "type": "object",
          "title": "Search Configuration",
          "description": "Search feature settings",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable Search",
              "default": true
            },
            "mode": {
              "type": "string",
              "title": "Search Mode",
              "enum": ["fuzzy", "exact"],
              "default": "fuzzy"
            },
            "minLength": {
              "type": "integer",
              "title": "Minimum Query Length",
              "minimum": 1,
              "maximum": 10,
              "default": 2
            },
            "threshold": {
              "type": "number",
              "title": "Fuzzy Match Threshold",
              "description": "0 = exact match, 1 = match anything",
              "minimum": 0,
              "maximum": 1,
              "default": 0.3
            },
            "fields": {
              "type": "array",
              "title": "Searchable Fields",
              "items": {
                "type": "string"
              },
              "default": ["title", "description", "address"]
            }
          }
        },
        "boundaries": {
          "type": "object",
          "title": "Boundary Settings",
          "description": "Geographic boundary configuration",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable Boundaries",
              "default": true
            },
            "file": {
              "type": "string",
              "title": "Boundary File",
              "description": "GeoJSON filename for boundary validation"
            },
            "strictValidation": {
              "type": "boolean",
              "title": "Strict Validation",
              "description": "Reject reports outside boundary",
              "default": true
            },
            "showBoundaryOnMap": {
              "type": "boolean",
              "title": "Show Boundary on Map",
              "default": true
            }
          }
        },
        "privacyNotice": {
          "type": "object",
          "title": "Privacy Notice",
          "description": "Privacy notice configuration for forms",
          "properties": {
            "enabled": {
              "type": "boolean",
              "title": "Enable Privacy Notice",
              "default": true
            },
            "modal": {
              "type": "boolean",
              "title": "Use Modal",
              "description": "Show privacy text in modal instead of external link",
              "default": true
            },
            "nodeId": {
              "type": "integer",
              "title": "Privacy Page Node ID",
              "description": "Drupal node ID containing privacy text"
            }
          }
        },
        "analytics": {
          "type": "object",
          "title": "Analytics",
          "description": "Analytics and tracking configuration",
          "properties": {
            "matomo": {
              "type": "object",
              "title": "Matomo Analytics",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "title": "Enable Matomo",
                  "default": false
                },
                "mode": {
                  "type": "string",
                  "title": "Tracking Mode",
                  "enum": ["tracking", "tag-manager"],
                  "default": "tracking"
                },
                "siteId": {
                  "type": "string",
                  "title": "Site ID"
                },
                "trackerUrl": {
                  "type": "string",
                  "title": "Tracker URL",
                  "format": "uri"
                },
                "containerId": {
                  "type": "string",
                  "title": "Container ID (for Tag Manager)"
                },
                "containerUrl": {
                  "type": "string",
                  "title": "Container URL",
                  "format": "uri"
                }
              }
            }
          }
        }
      }
    },
    "ui": {
      "type": "object",
      "title": "UI Layout",
      "description": "Layout and UI customization",
      "properties": {
        "headerHeight": {
          "type": "string",
          "title": "Header Height",
          "description": "CSS value for header height",
          "pattern": "^(auto|\\d+px|\\d+rem)$",
          "default": "120px",
          "examples": ["auto", "100px", "80px"]
        },
        "logoHeight": {
          "type": "string",
          "title": "Logo Height",
          "description": "CSS value for logo height",
          "pattern": "^\\d+px$",
          "default": "100px"
        },
        "sidebar": {
          "type": "object",
          "title": "Sidebar Settings",
          "properties": {
            "width": {
              "type": "string",
              "title": "Width",
              "description": "Sidebar width on desktop",
              "pattern": "^\\d+px$",
              "default": "420px"
            },
            "enabled": {
              "type": "boolean",
              "title": "Enabled",
              "description": "Show sidebar on desktop",
              "default": true
            }
          }
        },
        "bottomSheet": {
          "type": "object",
          "title": "Bottom Sheet (Mobile)",
          "properties": {
            "position": {
              "type": "string",
              "title": "Initial Position",
              "enum": ["low", "medium", "high"],
              "default": "medium"
            },
            "minimumHeight": {
              "type": "integer",
              "title": "Minimum Height (px)",
              "minimum": 100,
              "maximum": 500,
              "default": 140
            },
            "showHandle": {
              "type": "boolean",
              "title": "Show Handle",
              "default": true
            }
          }
        }
      }
    },
    "media": {
      "type": "object",
      "title": "Media Settings",
      "description": "Photo upload configuration",
      "properties": {
        "maxFiles": {
          "type": "integer",
          "title": "Max Files",
          "description": "Maximum number of photos per report",
          "minimum": 1,
          "maximum": 10,
          "default": 3
        },
        "maxFileSize": {
          "type": "integer",
          "title": "Max File Size (MB)",
          "description": "Maximum file size in megabytes",
          "minimum": 1,
          "maximum": 50,
          "default": 20
        }
      }
    },
    "languages": {
      "type": "object",
      "title": "Language Settings",
      "description": "Select which bundled languages to enable. Labels come from i18n.",
      "properties": {
        "available": {
          "type": "array",
          "title": "Available Languages",
          "description": "Language codes to enable for this jurisdiction",
          "items": {
            "type": "string",
            "enum": ["de", "de-ls", "en", "fr", "es", "it", "pt", "nl", "tr", "ar", "uk", "pl"]
          },
          "default": ["de", "en"],
          "uniqueItems": true
        },
        "default": {
          "type": "string",
          "title": "Default Language",
          "enum": ["de", "de-ls", "en", "fr", "es", "it", "pt", "nl", "tr", "ar", "uk", "pl"],
          "default": "de"
        }
      }
    },
    "map": {
      "type": "object",
      "title": "Map Settings",
      "description": "Map behavior and controls",
      "properties": {
        "loadMarkersOnInit": {
          "type": "boolean",
          "title": "Load Markers on Init",
          "description": "Load markers when map first loads",
          "default": true
        },
        "enableBoundsFiltering": {
          "type": "boolean",
          "title": "Enable Bounds Filtering",
          "description": "Update markers when map bounds change",
          "default": true
        },
        "deferredMap": {
          "oneOf": [
            {
              "type": "boolean",
              "title": "Simple Enable/Disable",
              "description": "Boolean for backward compatibility"
            },
            {
              "type": "object",
              "title": "Deferred Map Configuration",
              "description": "Full configuration for deferred map loading",
              "properties": {
                "enabled": {
                  "type": "boolean",
                  "title": "Enable Deferred Loading",
                  "description": "Defer map loading on mobile for performance",
                  "default": true
                },
                "preloadData": {
                  "type": "boolean",
                  "title": "Preload Data",
                  "description": "Preload list data using city-wide bbox from boundary",
                  "default": true
                },
                "limit": {
                  "type": "integer",
                  "title": "Preload Limit",
                  "description": "Maximum items to preload",
                  "minimum": 10,
                  "maximum": 500,
                  "default": 100
                }
              }
            }
          ],
          "default": true
        },
        "layerVisibility": {
          "type": "object",
          "title": "Layer Visibility",
          "description": "Configure layer visibility based on zoom levels",
          "properties": {
            "heatmap": {
              "type": "object",
              "properties": {
                "minZoom": {
                  "type": "integer",
                  "default": 0
                },
                "maxZoom": {
                  "type": "integer",
                  "default": 11
                },
                "fadeOut": {
                  "type": "boolean",
                  "default": true
                }
              }
            },
            "clusters": {
              "type": "object",
              "properties": {
                "minZoom": {
                  "type": "integer",
                  "default": 10
                },
                "maxZoom": {
                  "type": "integer",
                  "default": 12
                }
              }
            },
            "markers": {
              "type": "object",
              "properties": {
                "minZoom": {
                  "type": "integer",
                  "default": 12
                }
              }
            }
          }
        },
        "controls": {
          "type": "object",
          "title": "Map Controls",
          "properties": {
            "zoom": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": true},
                    "position": {"type": "string", "default": "centerRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 40}
                  }
                }
              ],
              "default": true
            },
            "tilt": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": false},
                    "position": {"type": "string", "default": "centerRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 20},
                    "options": {
                      "type": "object",
                      "properties": {
                        "angles": {
                          "type": "array",
                          "items": {"type": "integer"},
                          "default": [0, 30, 60]
                        },
                        "defaultAngle": {"type": "integer", "default": 0},
                        "expandable": {"type": "boolean", "default": true}
                      }
                    }
                  }
                }
              ],
              "default": false
            },
            "theme": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": true},
                    "position": {"type": "string", "default": "centerRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 30}
                  }
                }
              ],
              "default": true
            },
            "geolocation": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": false},
                    "position": {"type": "string", "default": "centerRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 10}
                  }
                }
              ],
              "default": false
            },
            "heatmap": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": false},
                    "initialState": {"type": "boolean", "title": "Initial Visibility", "default": true},
                    "position": {"type": "string", "default": "centerRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 60}
                  }
                }
              ],
              "default": false
            },
            "reports": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": true},
                    "position": {"type": "string", "default": "topRight"},
                    "weight": {"type": "integer", "default": 1}
                  }
                }
              ],
              "default": true
            },
            "attribution": {
              "oneOf": [
                {"type": "boolean"},
                {
                  "type": "object",
                  "properties": {
                    "enabled": {"type": "boolean", "default": true},
                    "position": {"type": "string", "default": "bottomRight"},
                    "positionMobile": {"type": "string", "default": "topLeft"},
                    "weight": {"type": "integer", "default": 10}
                  }
                }
              ],
              "default": true
            }
          }
        }
      }
    },
    "navigation": {
      "type": "object",
      "title": "Navigation Tabs",
      "description": "Configure visible tabs in the sidebar/bottom sheet",
      "properties": {
        "activeTab": {
          "type": "string",
          "title": "Default Active Tab",
          "enum": ["info", "list", "following", "stats"],
          "default": "info"
        },
        "tabs": {
          "type": "object",
          "title": "Tab Visibility",
          "properties": {
            "info": {
              "type": "boolean",
              "title": "Info Tab",
              "default": true
            },
            "list": {
              "type": "boolean",
              "title": "List Tab",
              "default": true
            },
            "following": {
              "type": "boolean",
              "title": "Following Tab",
              "default": true
            },
            "stats": {
              "type": "boolean",
              "title": "Stats Tab",
              "default": false
            }
          }
        }
      }
    },
    "filters": {
      "type": "object",
      "title": "Filter Settings",
      "properties": {
        "enabled": {
          "type": "object",
          "title": "Enabled Filters",
          "description": "Which filter types are enabled",
          "properties": {
            "status": {
              "type": "boolean",
              "title": "Status Filters",
              "default": true
            },
            "category": {
              "type": "boolean",
              "title": "Category Filters",
              "default": true
            },
            "time": {
              "type": "boolean",
              "title": "Time Filters",
              "default": true
            },
            "custom": {
              "type": "boolean",
              "title": "Custom Filters",
              "default": false
            }
          }
        },
        "groups": {
          "type": "object",
          "title": "Filter Groups",
          "description": "Group filters into primary (always visible) and secondary (collapsible)",
          "properties": {
            "primary": {
              "type": "array",
              "title": "Primary Filters",
              "description": "Always visible filters",
              "items": {"type": "string"},
              "default": ["status:*"]
            },
            "secondary": {
              "type": "array",
              "title": "Secondary Filters",
              "description": "Collapsible filters",
              "items": {"type": "string"},
              "default": ["category:*", "time:*"]
            }
          }
        },
        "behavior": {
          "type": "object",
          "title": "Filter Behavior",
          "properties": {
            "multiSelect": {
              "type": "boolean",
              "title": "Multi-Select",
              "default": true
            },
            "collapsible": {
              "type": "boolean",
              "title": "Collapsible",
              "default": true
            },
            "persistent": {
              "type": "boolean",
              "title": "Persistent",
              "description": "Remember filter state in localStorage",
              "default": true
            },
            "showClearAll": {
              "type": "boolean",
              "title": "Show Clear All",
              "default": true
            }
          }
        },
        "order": {
          "type": "array",
          "title": "Filter Order",
          "items": {"type": "string"},
          "default": ["status", "category", "time"]
        }
      }
    },
    "forms": {
      "type": "object",
      "title": "Form Settings",
      "properties": {
        "autoTriggerGeolocation": {
          "type": "boolean",
          "title": "Auto-trigger Geolocation",
          "description": "Request location when form opens",
          "default": true
        },
        "allowParentCategorySelection": {
          "type": "boolean",
          "title": "Allow Parent Category Selection",
          "description": "Let users select parent categories",
          "default": false
        },
        "pickOnMapButton": {
          "type": "boolean",
          "title": "Pick on Map Button",
          "description": "Show 'Pick on map' button in location field",
          "default": true
        }
      }
    },
    "privacy": {
      "type": "object",
      "title": "Privacy Settings",
      "properties": {
        "enabled": {
          "type": "boolean",
          "title": "Show Privacy Notice",
          "default": true
        },
        "modal": {
          "type": "boolean",
          "title": "Use Modal",
          "description": "Show privacy text in modal instead of external link",
          "default": true
        },
        "nodeId": {
          "type": "integer",
          "title": "Privacy Page Node ID",
          "description": "Drupal node ID containing privacy text"
        }
      }
    },
    "i18n": {
      "oneOf": [
        {
          "type": "string",
          "title": "Translation Overrides (JSON String)",
          "description": "Override specific translation keys as JSON string"
        },
        {
          "type": "object",
          "title": "Translation Overrides",
          "description": "Override specific translation keys. Example: {\"de\": {\"form.submit\": \"Meldung absenden\"}}",
          "properties": {
            "overrides": {
              "type": "object",
              "title": "Translation Overrides",
              "description": "Locale-keyed translation overrides",
              "additionalProperties": {
                "type": "object",
                "additionalProperties": {"type": "string"}
              }
            }
          },
          "additionalProperties": true
        }
      ]
    }
  },
  "additionalProperties": true
}
